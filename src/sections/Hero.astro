---
import { Icon } from "astro-icon/components";
import SplitText from "@components/SplitText.astro";
---

<section
  id="hero"
  class="relative w-full h-[100svh] bg-azul-marino-950 z-20 flex flex-col"
>
  <!-- Grid Pattern Overlay -->
  <div
    class="absolute inset-0 z-0 opacity-[0.02]"
    style="background-image: linear-gradient(rgba(111,182,63,0.3) 1px, transparent 1px), linear-gradient(90deg, rgba(111,182,63,0.3) 1px, transparent 1px); background-size: 60px 60px;"
  >
  </div>

  <!-- Background Image with Layered Effects -->
  <div
    id="hero-bg"
    class="absolute top-0 left-0 w-full h-[calc(100%+50px)] z-0 will-change-transform hero-bg-clip pointer-events-none"
    style="filter: drop-shadow(0 0 2px rgba(111, 182, 63, 0.8));"
  >
    <img
      src="/images/contenedores-avion-paquetes.jpg"
      alt="Contenedores maritimos internacionales"
      class="w-full h-[120%] object-cover -mt-[10%]"
    />
    <!-- Multi-layer gradient for depth -->
    <div
      class="absolute inset-0 bg-gradient-to-r from-azul-marino-950/95 via-azul-marino-950/70 to-azul-marino-950/20"
    >
    </div>
    <div
      class="absolute inset-0 bg-gradient-to-t from-azul-marino-950/80 via-transparent to-azul-marino-950/20"
    >
    </div>
    <!-- Subtle color tint -->
    <div class="absolute inset-0 bg-azul-oceano-900/10 mix-blend-multiply">
    </div>
  </div>

  <!-- Decorative Elements -->
  <div
    class="absolute top-1/4 right-[10%] w-64 h-64 bg-verde-global-500/10 rounded-full blur-[100px] z-0"
  >
  </div>
  <div
    class="absolute bottom-1/4 left-[5%] w-48 h-48 bg-azul-oceano-500/15 rounded-full blur-[80px] z-0"
  >
  </div>

  <!-- Shipping routes - left side, converging flow -->
  <div
    class="absolute inset-y-0 left-0 w-[50%] z-[1] pointer-events-none overflow-hidden"
  >
    <svg
      class="w-full h-full"
      viewBox="0 0 400 600"
      preserveAspectRatio="xMinYMid slice"
    >
      <defs>
        <linearGradient id="routeGreen" x1="0%" y1="0%" x2="100%" y2="0%">
          <stop offset="0%" style="stop-color:#6FB63F;stop-opacity:0"></stop>
          <stop offset="20%" style="stop-color:#6FB63F;stop-opacity:0.7"></stop>
          <stop offset="80%" style="stop-color:#9ED46A;stop-opacity:0.5"></stop>
          <stop offset="100%" style="stop-color:#9ED46A;stop-opacity:0"></stop>
        </linearGradient>
        <linearGradient id="routeBlue" x1="0%" y1="0%" x2="100%" y2="0%">
          <stop offset="0%" style="stop-color:#0E5F7C;stop-opacity:0"></stop>
          <stop offset="20%" style="stop-color:#0E5F7C;stop-opacity:0.6"></stop>
          <stop offset="80%" style="stop-color:#3fa7c7;stop-opacity:0.4"></stop>
          <stop offset="100%" style="stop-color:#3fa7c7;stop-opacity:0"></stop>
        </linearGradient>
        <linearGradient id="routeMix" x1="0%" y1="0%" x2="100%" y2="0%">
          <stop offset="0%" style="stop-color:#6FB63F;stop-opacity:0"></stop>
          <stop offset="30%" style="stop-color:#6FB63F;stop-opacity:0.5"></stop>
          <stop offset="70%" style="stop-color:#0E5F7C;stop-opacity:0.5"></stop>
          <stop offset="100%" style="stop-color:#0E5F7C;stop-opacity:0"></stop>
        </linearGradient>
      </defs>

      <!-- Rutas que entran desde la izquierda y fluyen hacia el centro -->
      <!-- Ruta superior - Europa a America -->
      <path
        d="M-50,80 Q80,60 180,120 T380,180"
        stroke="url(#routeGreen)"
        stroke-width="2"
        fill="none"
        class="route-path"
        opacity="0.8"></path>

      <!-- Ruta media-alta - Asia a Europa -->
      <path
        d="M-50,180 Q100,150 200,200 T400,280"
        stroke="url(#routeBlue)"
        stroke-width="1.5"
        fill="none"
        class="route-path"
        style="animation-delay: 1.5s"
        opacity="0.7"></path>

      <!-- Ruta central principal - la mas visible -->
      <path
        d="M-50,300 Q120,280 220,300 T420,320"
        stroke="url(#routeGreen)"
        stroke-width="2.5"
        fill="none"
        class="route-path"
        style="animation-delay: 0.8s"
        opacity="0.9"></path>

      <!-- Ruta media-baja -->
      <path
        d="M-50,400 Q100,420 200,380 T400,360"
        stroke="url(#routeMix)"
        stroke-width="1.5"
        fill="none"
        class="route-path"
        style="animation-delay: 2s"
        opacity="0.6"></path>

      <!-- Ruta inferior - Africa a Sudamerica -->
      <path
        d="M-50,520 Q80,480 180,460 T380,420"
        stroke="url(#routeBlue)"
        stroke-width="2"
        fill="none"
        class="route-path"
        style="animation-delay: 2.5s"
        opacity="0.7"></path>

      <!-- Lineas secundarias punteadas -->
      <path
        d="M-30,140 Q150,180 350,240"
        stroke="#6FB63F"
        stroke-width="1"
        stroke-dasharray="6,10"
        fill="none"
        opacity="0.3"></path>
      <path
        d="M-30,460 Q150,400 350,380"
        stroke="#0E5F7C"
        stroke-width="1"
        stroke-dasharray="6,10"
        fill="none"
        opacity="0.25"></path>
    </svg>
  </div>

  <!-- Content Container -->
  <div
    class="relative z-20 max-w-7xl mx-auto px-4 md:px-8 pt-24 md:pt-32 flex-1 flex items-center"
  >
    <div class="grid lg:grid-cols-5 gap-12 lg:gap-8 items-center w-full">
      <!-- Left Content -->
      <div class="lg:col-span-3 text-white">
        <!-- Badge -->
        <div
          class="inline-flex items-center gap-2 bg-azul-marino-800/95 backdrop-blur-sm border border-azul-oceano-600/30 rounded-full px-4 py-2 mb-6"
        >
          <div class="w-2 h-2 bg-verde-global-500 rounded-full animate-pulse">
          </div>
          <span class="text-azul-marino-100 text-xs tracking-wide"
            >Operando en 40+ paises</span
          >
        </div>

        <!-- Heading -->
        <div
          class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold leading-[1.05] tracking-tighter mb-6"
        >
          <SplitText
            text="Raices que nos unen"
            tag="h1"
            class="text-white block"
            splitBy="chars"
            delay={0}
            stagger={40}
          />
          <span
            class="text-verde-global-500 block text-2xl sm:text-3xl md:text-4xl lg:text-5xl"
          >
            <SplitText
              text="rutas que nos"
              tag="span"
              class="inline"
              splitBy="chars"
              delay={600}
              stagger={35}
            />
            <span
              class="inline-flex items-baseline relative ml-3 px-4 py-1"
              data-rotating-container
              data-words='["conectan", "expanden", "acercan"]'
            >
              <SplitText
                text="conectan"
                tag="span"
                class="rotating-word text-white relative z-10"
                splitBy="chars"
                delay={1100}
                stagger={40}
              />
              <span
                class="brush-svg text-azul-oceano-500 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[120%] h-[300%] pointer-events-none z-0 [&>svg]:w-full [&>svg]:h-full"
              >
                <Fragment
                  set:html={await import("/images/paint-brush.svg?raw").then(
                    (m) => m.default,
                  )}
                />
              </span>
            </span>
          </span>
        </div>

        <!-- Description -->
        <p
          class="text-azul-marino-200 text-base md:text-lg max-w-xl leading-relaxed mb-8"
        >
          Logistica internacional especializada en alimentos. Contenedores
          maritimos, paqueteria aerea y transporte local con rastreo en tiempo
          real.
        </p>

        <!-- CTA Buttons -->
        <div class="flex flex-wrap gap-4 mb-12">
          <a
            href="#cotizar"
            class="group relative inline-flex items-center gap-3 bg-verde-global-500 hover:bg-verde-global-400 text-azul-marino-950 font-bold py-4 px-7 rounded-xl transition-all duration-300 shadow-xl shadow-verde-global-500/25 hover:shadow-verde-global-400/40 hover:-translate-y-0.5"
          >
            <span>Cotizar Envio</span>
            <Icon
              name="tabler:arrow-right"
              class="w-5 h-5 group-hover:translate-x-1 transition-transform"
            />
          </a>

          <a
            href="#rastreo"
            class="group inline-flex items-center gap-3 bg-azul-marino-800/95 hover:bg-azul-marino-800 backdrop-blur-sm border border-azul-oceano-600/30 hover:border-azul-oceano-500/50 text-white font-medium py-4 px-7 rounded-xl transition-all duration-300"
          >
            <Icon
              name="tabler:map-pin-search"
              class="w-5 h-5 text-verde-global-400"
            />
            <span>Rastrear Paquete</span>
          </a>
        </div>

        <!-- Stats Row -->
        <div class="flex flex-wrap gap-x-8 gap-y-4">
          <div class="flex items-center gap-3">
            <div
              class="w-12 h-12 bg-azul-marino-800/95 backdrop-blur-sm border border-azul-oceano-600/20 rounded-xl flex items-center justify-center"
            >
              <Icon name="tabler:ship" class="w-6 h-6 text-verde-global-400" />
            </div>
            <div>
              <div class="text-white font-bold text-xl">2.5K+</div>
              <div class="text-azul-marino-400 text-xs tracking-wide">
                Contenedores/mes
              </div>
            </div>
          </div>

          <div class="flex items-center gap-3">
            <div
              class="w-12 h-12 bg-azul-marino-800/95 backdrop-blur-sm border border-azul-oceano-600/20 rounded-xl flex items-center justify-center"
            >
              <Icon name="tabler:plane" class="w-6 h-6 text-azul-oceano-400" />
            </div>
            <div>
              <div class="text-white font-bold text-xl">48h</div>
              <div class="text-azul-marino-400 text-xs tracking-wide">
                Entrega express
              </div>
            </div>
          </div>

          <div class="flex items-center gap-3">
            <div
              class="w-12 h-12 bg-azul-marino-800/95 backdrop-blur-sm border border-azul-oceano-600/20 rounded-xl flex items-center justify-center"
            >
              <Icon
                name="tabler:thermometer"
                class="w-6 h-6 text-verde-claro-400"
              />
            </div>
            <div>
              <div class="text-white font-bold text-xl">-25C</div>
              <div class="text-azul-marino-400 text-xs tracking-wide">
                Cadena de frio
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Right: Tracking Widget -->
      <div class="lg:col-span-2">
        <div
          class="bg-azul-marino-900/80 backdrop-blur-xl border border-azul-oceano-600/20 rounded-2xl p-6 md:p-8 shadow-2xl shadow-azul-marino-950/50"
        >
          <!-- Widget Header -->
          <div class="flex items-center gap-3 mb-6">
            <div
              class="w-10 h-10 bg-verde-global-500/20 rounded-xl flex items-center justify-center"
            >
              <Icon
                name="tabler:package"
                class="w-5 h-5 text-verde-global-400"
              />
            </div>
            <div>
              <h3 class="text-white font-bold">Rastreo Rapido</h3>
              <p class="text-azul-marino-400 text-xs">
                Ingresa tu numero de guia
              </p>
            </div>
          </div>

          <!-- Tracking Input -->
          <div class="relative mb-4">
            <input
              type="text"
              placeholder="RR-2024-XXXXXX"
              class="w-full bg-azul-marino-800/95 border border-azul-oceano-600/30 rounded-xl px-4 py-4 text-white placeholder-azul-marino-500 focus:outline-none focus:border-verde-global-500/50 focus:ring-1 focus:ring-verde-global-500/25 transition-all"
            />
            <button
              class="absolute right-2 top-1/2 -translate-y-1/2 p-2 bg-verde-global-500 hover:bg-verde-global-400 rounded-lg text-azul-marino-950 transition-colors"
            >
              <Icon name="tabler:search" class="w-5 h-5" />
            </button>
          </div>

          <!-- Quick Links -->
          <div class="grid grid-cols-2 gap-3 mb-6">
            <button
              class="flex items-center gap-2 p-3 bg-azul-marino-800/40 hover:bg-azul-marino-800/60 border border-azul-oceano-600/20 hover:border-azul-oceano-600/40 rounded-xl text-azul-marino-200 hover:text-white text-sm transition-all"
            >
              <Icon name="tabler:ship" class="w-4 h-4 text-azul-oceano-400" />
              <span>Maritimo</span>
            </button>
            <button
              class="flex items-center gap-2 p-3 bg-azul-marino-800/40 hover:bg-azul-marino-800/60 border border-azul-oceano-600/20 hover:border-azul-oceano-600/40 rounded-xl text-azul-marino-200 hover:text-white text-sm transition-all"
            >
              <Icon name="tabler:plane" class="w-4 h-4 text-verde-global-400" />
              <span>Aereo</span>
            </button>
          </div>

          <!-- Divider -->
          <div class="relative flex items-center gap-4 my-6">
            <div class="flex-1 h-px bg-azul-oceano-600/20"></div>
            <span class="text-azul-marino-500 text-xs">o contactanos</span>
            <div class="flex-1 h-px bg-azul-oceano-600/20"></div>
          </div>

          <!-- Contact Quick Action -->
          <a
            href="tel:+34555540069"
            class="flex items-center gap-4 p-4 bg-azul-marino-800/40 hover:bg-azul-marino-800/60 border border-azul-oceano-600/20 rounded-xl transition-all group"
          >
            <div
              class="w-12 h-12 bg-verde-global-500/20 group-hover:bg-verde-global-500/30 rounded-xl flex items-center justify-center transition-colors"
            >
              <Icon name="tabler:phone" class="w-6 h-6 text-verde-global-400" />
            </div>
            <div>
              <div class="text-azul-marino-400 text-xs">Linea directa 24/7</div>
              <div class="text-white font-bold text-lg">+34 555 540 069</div>
            </div>
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Scroll Indicator -->
  <div class="relative z-30 pb-6 flex justify-center">
    <a
      href="#servicios"
      class="pointer-events-auto cursor-pointer flex flex-col items-center gap-1 group no-underline"
    >
      <span
        class="text-[8px] md:text-xs font-bold uppercase tracking-widest text-white opacity-0 group-hover:opacity-100 transition-opacity duration-300"
        >Descubrir m√°s</span
      >
      <Icon
        name="tabler:chevron-down"
        class="w-6 h-6 md:w-8 md:h-8 text-white animate-bounce"
      />
    </a>
  </div>
</section>

<style>
  @reference "tailwindcss";

  .route-path {
    stroke-dasharray: 300;
    stroke-dashoffset: 300;
    animation: drawRoute 8s ease-in-out infinite;
  }

  .hero-bg-clip {
    clip-path: polygon(
      0 0,
      100% 0,
      100% calc(100% - 50px),
      calc(50% + 250px) calc(100% - 50px),
      calc(50% + 220px) 100%,
      calc(50% - 220px) 100%,
      calc(50% - 250px) calc(100% - 50px),
      0 calc(100% - 50px)
    );
    filter: drop-shadow(0 0 2px rgba(111, 182, 63, 0.5));
  }

  @keyframes drawRoute {
    0% {
      stroke-dashoffset: 300;
    }
    50% {
      stroke-dashoffset: 0;
    }
    100% {
      stroke-dashoffset: -300;
    }
  }

  @keyframes underlineGrow {
    0% {
      transform: scaleX(0);
      transform-origin: left;
    }
    30% {
      transform: scaleX(1);
      transform-origin: left;
    }
    70% {
      transform: scaleX(1);
      transform-origin: right;
    }
    100% {
      transform: scaleX(0);
      transform-origin: right;
    }
  }

  .animate-underline-grow {
    animation: underlineGrow 3s ease-in-out infinite;
    animation-delay: 2s;
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const container = document.querySelector(
      "[data-rotating-container]",
    ) as HTMLElement;
    if (!container) return;

    const words = JSON.parse(container.dataset.words || "[]");
    if (words.length === 0) return;

    const rotatingWord = container.querySelector(
      ".rotating-word",
    ) as HTMLElement;
    if (!rotatingWord) return;

    let currentIndex = 0;
    const stagger = 40;

    const createChars = (word: string, animateIn = false) => {
      rotatingWord.innerHTML = "";
      word.split("").forEach((char, i) => {
        const span = document.createElement("span");
        span.className = "split-char";
        span.textContent = char === " " ? "\u00A0" : char;
        span.style.setProperty("--char-delay", `${i * stagger}ms`);
        if (animateIn) {
          span.style.opacity = "0";
          span.style.transform = "translateY(30px)";
        }
        rotatingWord.appendChild(span);
      });
    };

    const animateOut = () => {
      const chars = rotatingWord.querySelectorAll(".split-char");
      chars.forEach((char, i) => {
        const el = char as HTMLElement;
        el.style.transition = `opacity 0.3s ease ${i * 25}ms, transform 0.3s ease ${i * 25}ms`;
        el.style.opacity = "0";
        el.style.transform = "translateY(-30px)";
      });
    };

    const animateIn = () => {
      const chars = rotatingWord.querySelectorAll(".split-char");
      requestAnimationFrame(() => {
        chars.forEach((char) => {
          const el = char as HTMLElement;
          el.style.transition = `opacity 0.5s ease var(--char-delay), transform 0.5s ease var(--char-delay)`;
          el.style.opacity = "1";
          el.style.transform = "translateY(0)";
        });
      });
    };

    const rotateWord = () => {
      animateOut();

      setTimeout(() => {
        currentIndex = (currentIndex + 1) % words.length;
        createChars(words[currentIndex], true);
        requestAnimationFrame(animateIn);
      }, 350);
    };

    setTimeout(() => {
      setInterval(rotateWord, 3000);
    }, 2500);
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/gsap@3/dist/gsap.min.js" is:inline
></script>
<script
  src="https://cdn.jsdelivr.net/npm/gsap@3/dist/ScrollTrigger.min.js"
  is:inline></script>
<script is:inline>
  document.addEventListener("DOMContentLoaded", () => {
    gsap.registerPlugin(ScrollTrigger);

    const heroBg = document.getElementById("hero-bg");
    const hero = document.getElementById("hero");
    const heroImg = heroBg ? heroBg.querySelector("img") : null;

    if (heroBg && hero && heroImg) {
      gsap.to(heroImg, {
        yPercent: 30,
        ease: "none",
        scrollTrigger: {
          trigger: hero,
          start: "top top",
          end: "bottom top",
          scrub: true,
        },
      });
    }
  });
</script>
