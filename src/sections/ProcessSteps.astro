---
import { Icon } from "astro-icon/components";

const steps = [
  {
    number: "01",
    title: "Solicita Cotizacion",
    description: "Completa el formulario con los detalles de tu carga y destino. Respuesta en menos de 2 horas.",
    icon: "tabler:file-text",
  },
  {
    number: "02",
    title: "Recogemos tu Carga",
    description: "Coordinamos la recoleccion en origen con vehiculos especializados y cadena de frio.",
    icon: "tabler:package-export",
  },
  {
    number: "03",
    title: "Transporte Seguro",
    description: "Monitoreamos tu envio 24/7 con GPS y sensores de temperatura en tiempo real.",
    icon: "tabler:route",
  },
  {
    number: "04",
    title: "Entrega Garantizada",
    description: "Recibe tu carga en destino con documentacion completa y confirmacion digital.",
    icon: "tabler:circle-check",
  },
];
---

<section id="proceso" class="relative py-24 md:py-32 bg-azul-marino-950 overflow-hidden">
  <!-- Background Elements -->
  <div class="absolute inset-0 opacity-[0.03]" style="background-image: linear-gradient(rgba(111,182,63,0.5) 1px, transparent 1px), linear-gradient(90deg, rgba(111,182,63,0.5) 1px, transparent 1px); background-size: 80px 80px;"></div>

  <div class="absolute top-0 right-0 w-96 h-96 bg-verde-global-500/10 rounded-full blur-[120px]"></div>
  <div class="absolute bottom-0 left-0 w-80 h-80 bg-azul-oceano-500/15 rounded-full blur-[100px]"></div>

  <div class="relative max-w-7xl mx-auto px-4 md:px-8">
    <!-- Header -->
    <div class="text-center mb-16 md:mb-20">
      <div class="inline-flex items-center gap-2 bg-azul-marino-800/80 backdrop-blur-sm border border-azul-oceano-600/30 rounded-full px-4 py-2 mb-6">
        <Icon name="tabler:arrows-right-left" class="w-4 h-4 text-verde-global-400" />
        <span class="text-azul-marino-100 text-xs tracking-wide font-medium">Proceso Simple</span>
      </div>

      <h2 class="text-3xl md:text-4xl lg:text-5xl font-bold text-white mb-6">
        Como <span class="text-verde-global-500">Funciona</span>
      </h2>

      <p class="text-azul-marino-300 text-lg max-w-2xl mx-auto leading-relaxed">
        En cuatro pasos llevamos tu carga desde el origen hasta su destino final con total transparencia y seguridad.
      </p>
    </div>

    <!-- Steps Container -->
    <div class="relative">
      <!-- Connection Line (Desktop) -->
      <div class="hidden lg:block absolute top-24 left-[calc(12.5%+24px)] right-[calc(12.5%+24px)] h-0.5 bg-gradient-to-r from-verde-global-500/50 via-azul-oceano-500/50 to-verde-global-500/50 process-line"></div>

      <!-- Steps Grid -->
      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8 lg:gap-6">
        {steps.map((step, index) => (
          <div
            class="process-step group relative"
            data-index={index}
            style={`--delay: ${index * 150}ms`}
          >
            <!-- Step Card -->
            <div class="relative bg-azul-marino-900/60 backdrop-blur-sm border border-azul-oceano-600/20 rounded-2xl p-6 md:p-8 hover:border-verde-global-500/40 transition-all duration-500 h-full">
              <!-- Number Badge -->
              <div class="absolute -top-4 left-6 bg-verde-global-500 text-azul-marino-950 text-sm font-bold px-3 py-1 rounded-full shadow-lg shadow-verde-global-500/30">
                {step.number}
              </div>

              <!-- Icon -->
              <div class="w-14 h-14 bg-azul-marino-800/80 border border-azul-oceano-600/30 rounded-xl flex items-center justify-center mb-6 mt-2 group-hover:bg-verde-global-500/20 group-hover:border-verde-global-500/40 transition-all duration-300">
                <Icon name={step.icon} class="w-7 h-7 text-verde-global-400 group-hover:text-verde-global-300 transition-colors" />
              </div>

              <!-- Content -->
              <h3 class="text-xl font-bold text-white mb-3 group-hover:text-verde-global-400 transition-colors">
                {step.title}
              </h3>

              <p class="text-azul-marino-300 text-sm leading-relaxed">
                {step.description}
              </p>

              <!-- Arrow (Desktop) -->
              {index < steps.length - 1 && (
                <div class="hidden lg:flex absolute -right-3 top-24 w-6 h-6 bg-azul-marino-950 border border-azul-oceano-600/30 rounded-full items-center justify-center z-10">
                  <Icon name="tabler:chevron-right" class="w-4 h-4 text-verde-global-500" />
                </div>
              )}
            </div>
          </div>
        ))}
      </div>
    </div>

    <!-- Bottom CTA -->
    <div class="text-center mt-16">
      <a
        href="#cotizar"
        class="group inline-flex items-center gap-3 bg-verde-global-500 hover:bg-verde-global-400 text-azul-marino-950 font-bold py-4 px-8 rounded-xl transition-all duration-300 shadow-xl shadow-verde-global-500/25 hover:shadow-verde-global-400/40 hover:-translate-y-0.5"
      >
        <span>Comenzar Ahora</span>
        <Icon name="tabler:arrow-right" class="w-5 h-5 group-hover:translate-x-1 transition-transform" />
      </a>
    </div>
  </div>
</section>

<style>
  @reference "tailwindcss";

  .process-line {
    background-size: 200% 100%;
    animation: shimmer 3s ease-in-out infinite;
  }

  @keyframes shimmer {
    0%, 100% { background-position: 200% 0; }
    50% { background-position: -200% 0; }
  }
</style>

<script is:inline>
  document.addEventListener("DOMContentLoaded", () => {
    if (typeof gsap !== "undefined" && typeof ScrollTrigger !== "undefined") {
      gsap.registerPlugin(ScrollTrigger);

      const steps = document.querySelectorAll(".process-step");

      steps.forEach((step, index) => {
        gsap.from(step, {
          scrollTrigger: {
            trigger: step,
            start: "top 85%",
          },
          y: 40,
          opacity: 0,
          duration: 0.6,
          delay: index * 0.15,
          ease: "power2.out",
        });
      });

      gsap.from(".process-line", {
        scrollTrigger: {
          trigger: ".process-line",
          start: "top 80%",
        },
        scaleX: 0,
        transformOrigin: "left center",
        duration: 1,
        ease: "power2.out",
      });
    }
  });
</script>
